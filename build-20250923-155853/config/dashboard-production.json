{
  "dashboard": {
    "title": "Traffic Router Production Dashboard",
    "refreshInterval": 30000,
    "theme": "dark",
    "layout": {
      "columns": 12,
      "rows": 8
    }
  },
  "widgets": [
    {
      "id": "system-overview",
      "type": "metrics-grid",
      "title": "System Overview",
      "position": { "x": 0, "y": 0, "w": 6, "h": 2 },
      "metrics": [
        {
          "name": "CPU Usage",
          "query": "avg(cpu_usage_percent)",
          "unit": "%",
          "threshold": { "warning": 70, "critical": 85 }
        },
        {
          "name": "Memory Usage",
          "query": "avg(memory_usage_percent)",
          "unit": "%",
          "threshold": { "warning": 80, "critical": 90 }
        },
        {
          "name": "Disk Usage",
          "query": "avg(disk_usage_percent)",
          "unit": "%",
          "threshold": { "warning": 80, "critical": 90 }
        },
        {
          "name": "Active Connections",
          "query": "sum(active_connections)",
          "unit": "",
          "threshold": { "warning": 1000, "critical": 1500 }
        }
      ]
    },
    {
      "id": "service-health",
      "type": "status-grid",
      "title": "Service Health",
      "position": { "x": 6, "y": 0, "w": 6, "h": 2 },
      "services": [
        {
          "name": "Main App",
          "endpoint": "http://localhost:3000/api/health",
          "expectedStatus": 200
        },
        {
          "name": "AI Proxy",
          "endpoint": "http://localhost:3001/health",
          "expectedStatus": 200
        },
        {
          "name": "Monitoring",
          "endpoint": "http://localhost:3002/health",
          "expectedStatus": 200
        },
        {
          "name": "YouTube Cache",
          "endpoint": "http://localhost:3003/health",
          "expectedStatus": 200
        },
        {
          "name": "MCP Server",
          "endpoint": "http://localhost:3004/health",
          "expectedStatus": 200
        },
        {
          "name": "Redis",
          "endpoint": "redis://localhost:6379",
          "type": "redis"
        },
        {
          "name": "PostgreSQL",
          "endpoint": "postgresql://localhost:5432",
          "type": "postgres"
        }
      ]
    },
    {
      "id": "request-metrics",
      "type": "time-series",
      "title": "Request Metrics",
      "position": { "x": 0, "y": 2, "w": 8, "h": 3 },
      "metrics": [
        {
          "name": "Requests per Second",
          "query": "rate(http_requests_total[1m])",
          "color": "#00ff00"
        },
        {
          "name": "Error Rate",
          "query": "rate(http_requests_total{status=~\"5..\"}[1m])",
          "color": "#ff0000"
        },
        {
          "name": "Response Time (95th percentile)",
          "query": "histogram_quantile(0.95, http_request_duration_seconds_bucket)",
          "color": "#0080ff"
        }
      ],
      "timeRange": "1h"
    },
    {
      "id": "error-log",
      "type": "log-viewer",
      "title": "Recent Errors",
      "position": { "x": 8, "y": 2, "w": 4, "h": 3 },
      "logFile": "/var/log/traffic-router/error.log",
      "maxLines": 50,
      "filter": "ERROR|CRITICAL",
      "autoRefresh": true
    },
    {
      "id": "ai-service-metrics",
      "type": "metrics-grid",
      "title": "AI Service Metrics",
      "position": { "x": 0, "y": 5, "w": 6, "h": 2 },
      "metrics": [
        {
          "name": "AI Requests/min",
          "query": "rate(ai_requests_total[1m]) * 60",
          "unit": "req/min"
        },
        {
          "name": "AI Success Rate",
          "query": "rate(ai_requests_total{status=\"success\"}[5m]) / rate(ai_requests_total[5m]) * 100",
          "unit": "%"
        },
        {
          "name": "Avg AI Response Time",
          "query": "avg(ai_response_time_seconds)",
          "unit": "s"
        },
        {
          "name": "Active AI Models",
          "query": "count(ai_model_active)",
          "unit": ""
        }
      ]
    },
    {
      "id": "cache-metrics",
      "type": "metrics-grid",
      "title": "Cache Performance",
      "position": { "x": 6, "y": 5, "w": 6, "h": 2 },
      "metrics": [
        {
          "name": "Cache Hit Rate",
          "query": "rate(cache_hits_total[5m]) / rate(cache_requests_total[5m]) * 100",
          "unit": "%",
          "threshold": { "warning": 70, "critical": 50 }
        },
        {
          "name": "Cache Size",
          "query": "cache_size_bytes",
          "unit": "bytes"
        },
        {
          "name": "YouTube Cache Hit Rate",
          "query": "rate(youtube_cache_hits_total[5m]) / rate(youtube_cache_requests_total[5m]) * 100",
          "unit": "%"
        },
        {
          "name": "Redis Memory Usage",
          "query": "redis_memory_used_bytes",
          "unit": "bytes"
        }
      ]
    },
    {
      "id": "network-metrics",
      "type": "time-series",
      "title": "Network Traffic",
      "position": { "x": 0, "y": 7, "w": 12, "h": 1 },
      "metrics": [
        {
          "name": "Inbound Traffic",
          "query": "rate(network_receive_bytes_total[1m])",
          "color": "#00ff00",
          "unit": "bytes/s"
        },
        {
          "name": "Outbound Traffic",
          "query": "rate(network_transmit_bytes_total[1m])",
          "color": "#ff8000",
          "unit": "bytes/s"
        }
      ],
      "timeRange": "1h"
    }
  ],
  "alerts": {
    "enabled": true,
    "rules": [
      {
        "name": "High CPU Usage",
        "condition": "avg(cpu_usage_percent) > 85",
        "severity": "critical",
        "duration": "5m"
      },
      {
        "name": "High Memory Usage",
        "condition": "avg(memory_usage_percent) > 90",
        "severity": "critical",
        "duration": "5m"
      },
      {
        "name": "Service Down",
        "condition": "up == 0",
        "severity": "critical",
        "duration": "1m"
      },
      {
        "name": "High Error Rate",
        "condition": "rate(http_requests_total{status=~\"5..\"}[5m]) > 0.1",
        "severity": "warning",
        "duration": "5m"
      },
      {
        "name": "Low Cache Hit Rate",
        "condition": "rate(cache_hits_total[5m]) / rate(cache_requests_total[5m]) < 0.7",
        "severity": "warning",
        "duration": "10m"
      }
    ]
  },
  "notifications": {
    "channels": [
      {
        "name": "slack",
        "type": "webhook",
        "url": "${SLACK_WEBHOOK_URL}",
        "enabled": true
      },
      {
        "name": "email",
        "type": "smtp",
        "config": {
          "host": "${SMTP_HOST}",
          "port": 587,
          "secure": false,
          "auth": {
            "user": "${SMTP_USER}",
            "pass": "${SMTP_PASS}"
          }
        },
        "enabled": true
      }
    ]
  }
}